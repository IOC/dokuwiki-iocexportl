\documentclass[oneside,a4paper,11pt,svgnames]{book}
% ***************** PACKAGES *****************
\usepackage[mathletters]{ucs}%Extended characters
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}       
\usepackage[catalan]{babel}
\usepackage{graphicx}
\usepackage{float}
\usepackage{longtable}
\usepackage{tabu}
\usepackage[table]{xcolor}
\usepackage{hyperref}
\usepackage{fancyhdr}%Customized headers
\usepackage[top=20mm, bottom=20mm, right=60mm, left=20mm]{geometry}
\usepackage{eso-pic}
\usepackage{textpos}%Set text in a position 
\usepackage{titlesec}
\usepackage{wallpaper}%Used in frontpage
\usepackage{tgtermes}
\usepackage{setspace}
\usepackage{marginnote}
\usepackage{ulem}
\usepackage[font={scriptsize,sf},labelfont={scriptsize,sf},textfont={scriptsize,sf},justification=justified,singlelinecheck=false]{caption}
\usepackage{grffile}%Accept dots on filenames
\usepackage{fixltx2e}%subscript, superscript
\usepackage{setspace}
\usepackage{listings}%code environment
\usepackage{dashrule}%customized rules
\usepackage{paralist}%Used to show quiz solutions
@IOCQRCODE@ %qrcodes

% ***************** CUSTOMIZED COMMANDS *****************
\newcommand{\fonttable}{\fontsize{7}{8.4}\fontfamily{phv}\selectfont}
\newcommand{\foottable}[1]{\fontsize{6}{7.2}\fontfamily{phv}\selectfont #1\fonttable}
\newcommand{\codeblock}{\renewcommand{\ttdefault}{fvm}\scriptsize}%beramono
\newcommand{\codeinline}{\renewcommand{\ttdefault}{fi4}}%inconsolata
\newcommand{\titleB}{\fontfamily{phv}\fontsize{8}{9.6}\selectfont\raggedright\bfseries}
\newcommand{\bodyB}{\fontsize{9}{10.8}\selectfont}
\newenvironment{titleG}{\fontfamily{phv}\fontsize{8}{9.6}\selectfont\bfseries}{\vspace*{-2mm} \\ \normalfont}
\newenvironment{bodyG}{\begin{spacing}{1.2}\fontfamily{phv}\fontsize{8}{9.6}\selectfont}{\end{spacing}\normalfont}
\newcommand{\textA}[1]{
		\vspace*{-3ex}
	\begin{flushleft}
		\colorbox{lightgray}{
			\begin{minipage}{0.98\textwidth}
				\vspace*{2mm}
				\centering
				\parbox[c]{0.95\textwidth}{#1}
				\vspace*{2mm}
			\end{minipage}
		}
	\end{flushleft}
}
\newcommand{\textB}[2]{
	\begin{center}
		\par
		\marginpar{
			\vspace{4mm}
			\parbox{\marginparwidth}{
				\titleB
				#1
				\normalsize
			}
		}
		\begin{minipage}{0.9\textwidth}
			\colorbox{colbodyB}{
				\centering
				\parbox{0.95\textwidth}{
					\centering
					\vspace*{2mm}
					\parbox[c]{0.85\textwidth}{
						\bodyB
						#2
						\normalfont
					}
					\vspace*{2mm}
				}
			}
		\end{minipage}
	\end{center}
}
\newcommand{\textG}[2]{
	\begin{center}
		\par
		\begin{minipage}{0.98\textwidth}
			\centering
			\parbox{0.95\textwidth}{
				\centering
				\vspace*{2mm}
				\parbox[c]{0.9\textwidth}{
					\begin{titleG}
						#1
					\end{titleG}
					\begin{bodyG}
						#2
					\end{bodyG}
					\normalfont
				}
				\vspace*{2mm}
			}
		\end{minipage}
	\end{center}
}
\newcommand{\notaBreu}[1]{
	\marginpar{
		\fcolorbox{black}{colbodyB}{
			\begin{minipage}{\marginparwidth-4mm}
				\vspace*{2mm}
		        \centering
				\parbox[c]{0.90\marginparwidth}{
					\raggedright
		        	\fontfamily{phv}
					\selectfont{
						\small{#1}
					}
				}
				\vspace*{2mm}
			\end{minipage}
		}
	}
}
\newcommand{\textX}[3]{
	\marginnote{
		\colorbox{colheadB}{
			\begin{minipage}[c]{\marginparwidth-4mm}\vspace*{2mm}
				\centering
				\parbox[c]{0.90\marginparwidth}{
					\fontfamily{phv}
					\selectfont
					\small
					\raggedright
					\bfseries
					\textcolor{white}{
						#1
						\vspace*{2mm}
					}
				}
			\end{minipage}
		}
		\\
		\colorbox{colbodyB}{
			\begin{minipage}{\marginparwidth-4mm}\vspace*{2mm}
				\centering
				\parbox[c]{0.90\marginparwidth}{
					\fontfamily{phv}
					\selectfont
					\small
					\raggedright
						#2
					\vspace*{2mm}
				}
			\end{minipage}
		}
	}[#3]
}
\newcommand{\imgB}[1]{
	\marginpar{#1}
}

\newcommand{\draft}[1]{
	\usepackage{draftwatermark}
	\SetWatermarkScale{0.8}
	\SetWatermarkText{\fontfamily{phv}\selectfont #1}
	\SetWatermarkLightness{0.9}
}

\newcommand{\defaultspacingpar}{
\setlength{\parskip}{2ex}%2 lines
}

\newcommand{\defaultspacingline}{
\renewcommand{\baselinestretch}{1.15}
}

\newcommand{\creditspacingpar}{
\setlength{\parskip}{0pt}
}

\newcommand{\creditspacingline}{
\renewcommand{\baselinestretch}{1.3}
}
\newcommand{\frontpageparskip}{
\setlength{\parskip}{2ex}
}

\newcommand{\numold}[1]{\fontfamily{pcr}\selectfont\tiny{#1}}
\lstnewenvironment{csource}[1]
	{\small
	 \lstset{basicstyle=\ttfamily,
			keywordstyle=\bfseries,
			numbers=left,
			inputencoding=utf8x,
			extendedchars=\true,
			numberstyle=\numold,
			breaklines=\true,
			frame=lines,
			framexleftmargin=0.5em,
			framexrightmargin=0.5em,
			backgroundcolor=\color[rgb]{0.97,0.97,0.97},
			showstringspaces=\false,
			#1,
			literate={é}{{\'e}}1
					 {í}{{\'i}}1
					 {ó}{{\'o}}1
					 {ú}{{\'u}}1
				     {à}{{\`a}}1
					 {è}{{\`e}}1
					 {ò}{{\`o}}1
					 {ï}{{\"i}}1
					 {ü}{{\"u}}1
					 {ç}{{\c{c}}}1
		}
	}
	{}
\newcommand{\tableheadrule}{
	\hdashrule{.5\textwidth}{0.3mm}{0.3mm 3mm}
}

\newcommand{\quizrule}[1]{
	\parbox[b]{#1}{
		\hdashrule{#1}{0.2mm}{0.2mm 0mm}
	}
}

\newenvironment{mediaurl}[1]
	{
		\qrcode{
			 \begin{pspicture}(10mm,10mm)
				\psbarcode{#1}{}{qrcode}
			 \end{pspicture}
		}
		\begin{minipage}[c][30mm]{\textwidth}
		\begin{tabular}[h]{b{32px}p{\textwidth}}
	}
	{
		\end{tabular}\\
		\end{minipage}
	}

\newcommand{\qrcode}[1]{
	\par
	\marginpar{
		\vspace{4mm}
		\resizebox{30mm}{!}{#1}
	}
}

\newcommand{\optrelations}[1]{
	\begin{center}
	\begin{minipage}{0.9\textwidth}
		\centering
		\framebox[0.95\textwidth][c]{
			\vspace*{2mm}
			\parbox[c]{0.85\textwidth}{
				\centering
				\begin{inparaenum}[\bfseries a) ]
					\quizoptions
					#1
					\normalfont
				\end{inparaenum}
			}
			\vspace*{2mm}
		}
	\end{minipage}
	\end{center}
}

%Fonts size
\renewcommand{\footnotesize}{\fontsize{7.5}{9}\selectfont}
\renewcommand{\tiny}{\fontsize{6}{7.2}\selectfont}
\renewcommand{\small}{\fontsize{7.5}{9}\selectfont}
\renewcommand{\scriptsize}{\fontsize{8.5}{10.2}\selectfont}
\renewcommand{\normalsize}{\fontsize{11}{13.2}\selectfont}
\renewcommand{\large}{\bfseries\fontsize{11}{13.2}\selectfont}
\renewcommand{\Large}{\fontsize{13}{15.6}\selectfont}
\renewcommand{\LARGE}{\fontsize{14}{16.8}\selectfont}
\renewcommand{\huge}{\fontsize{17}{20.4}\selectfont}
\renewcommand{\Huge}{\fontsize{30}{36}\selectfont}
\newcommand{\subsub}{\fontsize{10}{11.2}\selectfont}
\newcommand{\quizoptions}{\fontsize{9}{10.8}\selectfont}
\normalsize

%Customize headings
\newcommand{\headingnonumbers}{
	\titleformat{\chapter}[display]
	{\normalfont\bfseries}{}{0pt}{\fontfamily{phv}\selectfont\large}
	\titlespacing*{\chapter}{0pt}{-20pt}{60pt}
	\titleformat{\section}[display]
	{\normalfont\bfseries}{}{0pt}{\fontfamily{phv}\selectfont\normalsize\bfseries }
	\titleformat{\subsection}[display]
	{\normalfont\bfseries}{}{0pt}{\fontfamily{phv}\selectfont\normalsize\bfseries }
}

\newcommand{\headingnumbers}{
	\titleformat{\chapter}[display]
	{\normalfont\bfseries}{}{0pt}{\fontfamily{phv}\selectfont\large \thechapter.\ }
	\titlespacing*{\chapter}{0pt}{-20pt}{60pt}
	\titleformat{\section}[display]
	{\normalfont\bfseries}{}{0pt}{\fontfamily{phv}\selectfont\normalsize\bfseries \thesection\ }
	\titleformat{\subsection}[display]
	{\normalfont\bfseries}{}{0pt}{\fontfamily{phv}\selectfont\normalsize\bfseries \thesubsection\ }
	\titleformat{\subsubsection}[display]
	{\normalfont\bfseries}{}{0pt}{\fontfamily{phv}\selectfont\subsub\bfseries }
}

%Remove links style 
\hypersetup{colorlinks=false,pdfborder={0 0 0},}

%Set head width
\setlength{\headwidth}{170mm}

%Header fancy pages
\pagestyle{fancy}
\lhead{\fontfamily{phv}\selectfont{\tiny{@IOC_EXPORT_CREDIT@}}}
\chead{}%no page number in toc page
\rhead{\fontfamily{phv}\selectfont{\tiny{@IOC_EXPORT_NOMCOMPLERT@}}}
\lfoot{}
\cfoot{}
\rfoot{}

%Header plain pages
\fancypagestyle{plain}{
	\fancyhf{}
	\fancyhead[LO]{\fontfamily{phv}\selectfont{\tiny{@IOC_EXPORT_CREDIT@}}}
	\fancyhead[CO]{}%no page number in toc page
	\fancyhead[RO]{\fontfamily{phv}\selectfont{\tiny{@IOC_EXPORT_NOMCOMPLERT@}}}
	\fancyfoot[RO]{}
}

\setlength{\headheight}{13.6pt}


\definecolor{lightgray}{gray}{0.8}
\definecolor{hardgray}{gray}{0.6}
\definecolor{colheadB}{gray}{0.4}
\definecolor{colbodyB}{gray}{0.94}

%margins
\marginparwidth = 35mm
\marginparsep = 5mm
\textwidth = 13cm

%separation line 
\defaultspacingline
\sloppy

%remove indenting
\setlength{\parindent}{0in}

%table row height
\renewcommand{\arraystretch}{1.5}

%change characters
\DeclareUnicodeCharacter{2022}{·}%•
